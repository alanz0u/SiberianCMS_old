<li class="dropdown languages">
    <a id="dLabel"
       data-target="#"
       data-toggle="dropdown"
       role="button"
       aria-haspopup="true"
       aria-expanded="false"
       class="language-selector capitalize reverse sb-tour"><?php echo Core_Model_Language::getCurrentLanguage(); ?> <span class="caret"></span></a>
    <ul class="dropdown-menu content-white-bkg">
        <?php foreach (Core_Model_Language::getLanguages() as $language) : ?>
        <li <?php if(Core_Model_Language::getCurrentLanguage() == $language->getCode()) : ?> class="active"<?php endif; ?>>
            <a href="<?php echo $this->getCurrentUrl(true, $language->getCode()); ?>"
               rel="<?php echo strtolower($language->getCode()) ?>"
               class="hook-language">
                <!-- Nope, not ready yet ...
                <img src="/app/sae/design/desktop/flat/images/flags/svg/<?php echo strtolower(explode("_", $language->getCode())[0]) ?>.svg"
                     style="width: 24px; height: 16px; margin-right: 15px; border-radius: 1px;" />
                -->
                <?php echo $language->getName(); ?>
            </a>
        </li>
        <?php endforeach ?>
    </ul>
</li>

<script type="text/javascript">
    $(document).off('click', '.hook-language');
    $(document).on('click', '.hook-language', function () {
        var el = $(this);
        localStorage.setItem('sb-current-language', el.attr('rel'));
        setTimeout(function () {
            window.location = el.attr('href');
        }, 500);
    });
</script>
