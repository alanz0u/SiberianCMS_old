<div>
    <section class="avatar text-center padding">
        <div>
            <img width="150"
                 height="150"
                 ng-src="{{ avatarUrl() }}"
                 src="data:image/jpeg;base64,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"
                 class="padding stable-bg stable-border customer-image"
                 ng-click="editProfilePicture()"/>
        </div>
    </section>

    <div class="list"
         ng-class="{'card': card_design}">
        <form autocomplete="off">
            <label class="item item-input item-custom item-select"
                   ng-if="myAccount.settings.use_civility || myAccount.settings.extra_civility">
                <div class="input-label">
                    {{ ::'Civility' | translate:'customer' }}
                    <span ng-if="myAccount.settings.use_civility || myAccount.settings.extra_civility_required">*</span>
                </div>
                <select ng-model="customer.civility">
                    <option value="">{{ ::'Select' | translate:'customer' }}</option>
                    <option value="mr">{{ ::'Mr' | translate:'customer' }}</option>
                    <option value="ms">{{ ::'Ms' | translate:'customer' }}</option>
                </select>
            </label>

            <label class="item item-input item-custom">
                <div class="input-label">
                    {{ ::'Firstname' | translate:'customer' }} <span>*</span>
                </div>
                <input class="text-right"
                       type="text"
                       placeholder="{{ ::'Firstname' | translate:'customer' }}"
                       ng-model="customer.firstname"/>
            </label>

            <label class="item item-input item-custom">
                <div class="input-label">
                    {{ ::'Lastname' | translate:'customer' }} <span>*</span>
                </div>
                <input class="text-right"
                       type="text"
                       placeholder="{{ ::'Lastname' | translate:'customer' }}"
                       ng-model="customer.lastname"/>
            </label>

            <label ng-if="myAccount.settings.use_birthdate || myAccount.settings.extra_birthdate"
                   class="item item-input item-custom"
                   sb-datetime-picker
                   headers="true"
                   format="'DD/MM/YYYY'"
                   title="i18n.localBirthdateTitle"
                   model="customer.birthdate">
                <div class="input-label">
                    {{ ::'Birthdate' | translate:'customer' }}
                    <span ng-show="myAccount.settings.use_birthdate || myAccount.settings.extra_birthdate_required">*</span>
                </div>
                <input type="text"
                       class="text-right"
                       style="cursor: pointer !important;"
                       ng-model="customer.birthdate"
                       readonly="readonly" />
            </label>

            <label class="item item-input item-custom"
                   ng-if="myAccount.settings.use_nickname || myAccount.settings.extra_nickname">
                <div class="input-label">
                    {{ ::'Nickname' | translate:'customer' }}
                    <span ng-show="myAccount.settings.use_nickname || myAccount.settings.extra_nickname_required">*</span>
                </div>
                <input class="text-right"
                       type="text"
                       placeholder="{{ ::'Nickname' | translate:'customer' }}"
                       ng-model="customer.nickname"/>
            </label>

            <label class="item item-input item-custom">
                <div class="input-label">
                    {{ ::'Email' | translate:'customer' }} <span>*</span>
                </div>
                <input class="text-right"
                       type="text"
                       ng-disabled="customer.isLoggedIn"
                       placeholder="{{ ::'Email' | translate:'customer' }}"
                       ng-model="customer.email"/>
            </label>

            <div class="item item-input item-custom iti-mobile-custom"
                   ng-if="myAccount.settings.use_mobile || myAccount.settings.extra_mobile">
                <div class="input-label">
                    {{ ::'Mobile' | translate:'customer' }} <span ng-if="myAccount.settings.use_mobile || myAccount.settings.extra_mobile_required">*</span>
                </div>
                <input class="text-right customer_mobile_iti"
                       id="customer_mobile"
                       name="{{ 'random_mobile_phone_' + Date.now() }}"
                       type="text"
                       ng-model="customer.intl_mobile"/>
            </div>

            <label class="item item-custom bold item-icon-right"
                   style="padding-left: 15px;"
                   ng-click="customer.change_password = !customer.change_password; checkPasswordStatus()"
                   ng-if="customer.is_logged_in">
                <span>{{ ::'Change password' | translate:'customer' }}</span>
                <i class="icon" ng-class="{'ion-ios-arrow-up': customer.change_password, 'ion-ios-arrow-down': !customer.change_password}"></i>
            </label>

            <label class="item item-input item-custom"
                   ng-if="customer.change_password && customer.is_logged_in">
                <div class="input-label">
                    {{ ::'Current password' | translate:'customer' }}<span>&nbsp;*</span>
                </div>
                <input class="text-right"
                       type="password"
                       name="{{ ::rndOldPassword }}"
                       ng-disabled="!customer.change_password"
                       placeholder="{{ 'Current password' | translate:'customer' }}"
                       ng-model="customer.old_password"/>
            </label>
            <label class="item item-input item-custom"
                   ng-if="customer.change_password || !customer.is_logged_in">
                <div class="input-label">
                    <span ng-show="!customer.change_password">{{ ::'Password' | translate:'customer' }}</span>
                    <span ng-show="customer.change_password">{{ ::'New password' | translate:'customer' }}</span>
                    <span>&nbsp;*</span>
                </div>
                <input class="text-right"
                       type="password"
                       name="{{ ::rndPassword }}"
                       ng-disabled="!customer.change_password && customer.is_logged_in"
                       placeholder="{{ ::'Password' | translate:'customer' }}"
                       ng-model="customer.password"/>
            </label>

            <label class="item item-input item-custom"
                   ng-if="myAccount.settings.enable_password_verification && (customer.change_password || !customer.is_logged_in)">
                <div class="input-label">
                    <span>{{ ::'Repeat password' | translate:'customer' }}</span>
                    <span>&nbsp;*</span>
                </div>
                <input class="text-right"
                       type="password"
                       name="{{ ::rndPasswordRepeat }}"
                       style="cursor: text !important;"
                       placeholder="{{ ::'Repeat password' | translate:'customer' }}"
                       ng-model="customer.repeat_password"/>
            </label>

            <sb-clickwrap field="privacyPolicyField"
                          ng-if="!customer.is_logged_in"
                          model="customer.privacy_policy"
                          card-design="card_design"></sb-clickwrap>

            <ion-checkbox class="checkbox-custom item-custom item-text-wrap"
                          ng-model="customer.communication_agreement"
                          ng-if="myAccount.settings.enable_commercial_agreement">
                {{ ::myAccount.settings.enable_commercial_agreement_label | translate:'customer' }}
            </ion-checkbox>

            <ion-checkbox class="checkbox-custom item-custom"
                          ng-model="customer.show_in_social_gaming"
                          ng-if="myAccount.settings.use_ranking">
                {{ ::'Show me in ranking' | translate:'customer' }}
            </ion-checkbox>
        </form>
    </div>

    <div class="list"
         ng-class="{'card': card_design}"
         ng-repeat="cfo in custom_fields track by $index">
        <ion-item class="item-divider item-divider-custom">
            <p>{{ cfo.name }}:</p>
        </ion-item>

        <label ng-repeat="cf in cfo.custom_fields track by $index"
               class="item item-input item-custom">
            <div class="input-label">
                {{ cf.label | translate }}
            </div>
            <input class="text-right"
                   type="{{cf.type}}"
                   placeholder="{{ cf.label | translate }}"
                   ng-model="customer.metadatas[cfo.code][cf.key]"/>
        </label>
    </div>

    <!-- Version #2 of the custom login fields -->
    <div class="list"
         ng-class="{'card': card_design}"
         ng-repeat="fields in customer.extendedFields track by $index">
        <div ng-repeat="field in fields track by field.key"
             ng-if="displayField(field)"
             ng-include="'templates/customer/account/l1/fields/' + field.type + '.html'"></div>
    </div>

    <div class="list"
         ng-if="customer.metadatas.fidelity_points"
         ng-class="{'card': card_design}">
        <ion-item class="item-divider item-divider-custom">
            {{ ::'Loyalty program' | translate:'customer' }}
        </ion-item>

        <label class="item item-input item-custom">
            <div class="input-label">
                {{ ::'Loyalty points' | translate:'customer' }}
            </div>
            <input class="text-right"
                   type="text"
                   readonly="readonly"
                   value="{{ customer.metadatas.fidelity_points.points }}" />
        </label>
    </div>

    <div class="list"
         style="padding: 0 !important;"
         ng-if="customer.stripe"
         ng-class="{'card': card_design}">
        <ion-item class="item-divider item-divider-custom">
            {{ ::'Stored card information' | translate:'customer' }}
        </ion-item>

        <!-- SHOW CARD -->
        <div ng-show="customer.stripe.brand"
             class="item item-custom">
            <span>{{ ::'**** **** ****' }} {{ customer.stripe.last4 }} - {{ ::'CVC ***' }}</span>
            <span class="text-right">{{ ::'EXP' }} {{ customer.stripe.exp_month }}/{{ customer.stripe.exp_year }}</span>
        </div>
        <button ng-show="customer.stripe.brand"
                type="button"
                style="margin: 0 !important;"
                class="button button-full button-assertive button-assertive-custom"
                ng-click="removeCreditCard()">{{ ::'Remove card' | translate:'customer' }}
        </button>

        <!-- ADD CARD -->
        <label ng-show="!customer.stripe.brand"
               class="item item-text-wrap item-custom">
            {{ ::'You have no card stored. To add a card make an order.' | translate:'customer' }}
        </label>
    </div>

    <div class="padding text-right"
         ng-if="customer.is_logged_in">
        <span ng-click="showPrivacyPolicy()">
            {{ ::'Read the' | translate:'customer' }}&nbsp;<span class="bold positive positive-custom">{{ ::'privacy policy' | translate:'customer' }}!</span>
        </span>
    </div>

    <div ng-class="{'padding': card_design}">
        <button class="button button-positive button-positive-custom"
                ng-click="registerOrSave()"
                ng-class="{'button-block': card_design, 'button-full': !card_design}"
                ng-show="!is_loading">
            <span ng-if="customer.is_logged_in">{{ ::'Save' | translate:'customer' }}</span>
            <span ng-if="!customer.is_logged_in">{{ ::'Register' | translate:'customer' }}</span>
        </button>
    </div>

    <div class="padding text-center"
         ng-click="requestGdprToken()"
         ng-if="customer.is_logged_in && gdpr.isEnabled">
        {{ ::'Request access to my' | translate:'customer' }}&nbsp;<span class="bold positive positive-custom">{{ ::'personal data' | translate:'customer' }}!</span>
    </div>

    <div class="padding text-center"
         ng-click="displayLoginForm()"
         ng-if="!customer.is_logged_in">
        {{ ::'Already have an account?' | translate:'customer' }} <span class="bold positive positive-custom">{{ ::'Log in' | translate:'customer' }}!</span>
    </div>

    <div class="padding text-center"
         ng-click="logout()"
         ng-if="customer.is_logged_in">
        <span class="bold positive positive-custom">{{ ::'Log out' | translate:'customer' }}!</span>
    </div>

</div>
